---
title: "Profile";

import Layout from "@/layouts/Layout.astro";
import Main from "@/components/Main.astro";
import Profile_section from "@/sections/Profile_section.astro";
import type {sessionInfoState} from "@/models/types"; // prettier-ignore

//Session Reading////////////////
let sessionInfoState: sessionInfoState = {} as sessionInfoState; // prettier-ignore
const sessionInfoStateValue = Astro.cookies.get("sessionInfoState")?.value;
sessionInfoState = sessionInfoStateValue 
  ? JSON.parse(sessionInfoStateValue) as sessionInfoState 
  : {} as sessionInfoState;

console.log("sessionCookie", sessionInfoState);

const userName =
  sessionInfoState.sessionInfo.profile?.username ||
  sessionInfoState.sessionInfo.OAuth.user?.name ||
  "a Imagen";
---

<Layout title=`Bienvenido ${userName}`>
  <Main>
    <Profile_section
      profilePhotoSrc={sessionInfoState.sessionInfo.profilePhotoSrc}
      role={sessionInfoState.sessionInfo.role}
    >
      <h1 slot="header">Este es el encabezado</h1>
      <p>{sessionInfoState.sessionInfo.role}</p>
      <p>Este es el contenido principal</p>
      <p slot="user">
        usuario: {sessionInfoState.sessionInfo.profile?.username}
      </p>
      <p slot="id">id: {sessionInfoState.sessionInfo.profile?.id}</p>
      <p slot="mail">mail: {sessionInfoState.sessionInfo.profile?.email}</p>
    </Profile_section>
  </Main>
</Layout>
